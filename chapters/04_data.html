<!doctype html>
<head>
  <meta charset="utf-8">
  <title>Estructuras de Datos: Objetos y Arreglos :: Eloquent JavaScript</title>
  <link rel=stylesheet href="js/node_modules/codemirror/lib/codemirror.css">
  <script src="js/acorn_codemirror.js"></script>
  <link rel=stylesheet href="css/ejs.css">
  <script src="js/sandbox.js"></script>
  <script src="js/ejs.js"></script>
  <script>var chapNum = 4;var sandboxLoadFiles = ["code/jacques_journal.js", "code/chapter/04_data.js"];</script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-53624335-3', 'auto');
  ga('send', 'pageview');

  </script>
</head>

<article>
<nav>
  <a href="03_functions.html" title="capítulo previo">◀</a>
  <a href="index.html" title="cover">◆</a>
  <a href="05_higher_order.html" title="capítulo siguiente">▶</a>
</nav>

<h1><div class=chap_num>Capítulo 4</div>Estructuras de Datos: Objetos y Arreglos</h1>
<blockquote>
<p><a class=p_ident id="p_AF14oG5tGE" href="#p_AF14oG5tGE"></a>En dos ocasiones me han preguntado “Disculpe, Sr. Babbage, si introduce los
números incorrectos en la máquina, ¿van a salir las respuestas correctas?”
[...] No puedo terminar de comprender el tipo de confusión de ideas que
podrían provocar esta pregunta.</p>
 <footer>Charles Babbage, <cite>Passages from the Life of a Philosopher (1864)</cite></footer>
</blockquote>
<p><a class=p_ident id="p_FVxq6Uf2rv" href="#p_FVxq6Uf2rv"></a>Números, Booleanos
y cadenas son los ladrillos de los que están hechas las estructuras de datos.
Pero no podrás construir mucha casa de un solo ladrillo. Los <em>objetos</em> nos
permiten agrupar valores, incluyendo otros objetos, permitiéndonos construir
estructuras más complejas.</p>
<p><a class=p_ident id="p_lP6aJVStsL" href="#p_lP6aJVStsL"></a>Los programas que hemos construido hasta ahora han sido seriamente limitados
debido al hecho de que estaban operando únicamente en tipos de datos simples. Este
capítulo agregará a tu caja de herramientas un entendimiento básico de las
estructuras de datos. Al finalizarlo, sabrás lo suficiente para empezar a escribir
algunos programas de utilidad.</p>
<p><a class=p_ident id="p_MCaISwxTsj" href="#p_MCaISwxTsj"></a>El capítulo trabajará a lo largo de un ejemplo de programación más o menos
realista, introduciendo conceptos conforme apliquen al problema en cuestión.
El código de ejemplo muchas veces construirá sobre funciones y variables que
fueron presentadas previamente en el texto.</p>
<h2><a class=h_ident id="h_f3JQiZSoj8" href="#h_f3JQiZSoj8"></a>El hombre ardilla</h2>
<p><a class=p_ident id="p_ILCOYpDrw1" href="#p_ILCOYpDrw1"></a>De vez en cuando, comúnmente
entre las ocho y las diez de la noche, Jacques  se transforma en
un pequeño y peludo roedor con una frondosa cola.</p>
<p><a class=p_ident id="p_JWDybfL/03" href="#p_JWDybfL/03"></a>Por un lado, Jacques esta bastante contento de no tener la clásica licantropía.
Convertirse en una ardilla suele causar menos problemas que convertirse en un
lobo. En vez de tener que preocuparse por comerse accidentalmente a un vecino
(<em>eso</em> sería penoso), le preocupa el ser deborado por el gato del vecino.
Después de un par de ocasiones donde se despertó, en una
delgada rama en la cima de un roble, desnudo y desorientado, se ha asegurado
de cerrar puertas y ventanas de su cuarto por las noches y poner algunas
bellotas en el suelo para mantenerse ocupado.</p>
<div class="image">
  <img src="img/weresquirrel.png" alt="The weresquirrel">
</div>
<p><a class=p_ident id="p_t8snrXUbD8" href="#p_t8snrXUbD8"></a>Eso resuelve los problemas del gato y el roble. Pero Jacques aún sufre de su
enfermedad. Las ocurrencias irregulares de la transformación le hacen
sospechar que pudieran ser detonadas por algo. Por algún tiempo, creyó que
sucedía sólo en los dias que había tocado árboles. Así que dejó de tocar árboles
de manera definitiva e incluso evitó acercarse a ellos. Pero el problema
presistió.</p>
<p><a class=p_ident id="p_JnDiVDnGkd" href="#p_JnDiVDnGkd"></a>Cambiando a una perspectiva más científica, Jacques intenta
empezar un registro diario de todo lo que hizo ese día y si tuvo una
transformación. Con estos datos espera limitar las condiciones que disparan las
transformaciones.</p>
<p><a class=p_ident id="p_8Y5Ju5fKpt" href="#p_8Y5Ju5fKpt"></a>Lo primero que hace es diseñar una estructura de datos para almacenar esta
información.</p>
<h2><a class=h_ident id="h_7lZW6LyfA5" href="#h_7lZW6LyfA5"></a>Conjuntos de datos</h2>
<p><a class=p_ident id="p_970mNfCcKX" href="#p_970mNfCcKX"></a>Para trabajar con un pedazo de datos digitales, primero
tendremos que encontrar una forma de representarlo en la memoria de nuestra
máquina. Digamos, como un pequeño ejemplo, que queremos representar una
colección de números: 2, 3, 5, 7 y 11.</p>
<p><a class=p_ident id="p_0JXdWfoFby" href="#p_0JXdWfoFby"></a>Podríamos ponernos creativos usando cadenas; después de todo, las
cadenas pueden ser de cualquier longitud, así que podemos poner mucha
información en ellas; y usar <code>"2 3 5 7 11"</code> como nuestra representación. Pero
esto es incómodo. De alguna forma tendrías que extraer los dígitos y convertirlos
de vuelta a números para acceder a ellos.</p>
<p><a class=p_ident id="p_E6FJenluA8" href="#p_E6FJenluA8"></a>Afortunadamente, Javascript proporciona un
tipo de dato específico para almacenar secuencias de valores. Se le llama
<em>arreglo</em> (array) y se escribe como una lista de valores entre corchetes, separados
por comas.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_DJ8HZWEYTP" href="#c_DJ8HZWEYTP"></a><span class="cm-keyword">var</span> <span class="cm-variable">listaDeNumeros</span> <span class="cm-operator">=</span> [<span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">5</span>, <span class="cm-number">7</span>, <span class="cm-number">11</span>];
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">listaDeNumeros</span>[<span class="cm-number">1</span>]);
<span class="cm-comment">// → 3</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">listaDeNumeros</span>[<span class="cm-number">1</span> <span class="cm-operator">-</span> <span class="cm-number">1</span>]);
<span class="cm-comment">// → 2</span></pre>
<p><a class=p_ident id="p_Y7cmBj9QZD" href="#p_Y7cmBj9QZD"></a>La notación para obtener los elementos
dentro de un arreglo también utiliza corchetes. Un par de corchetes
inmediatamente después de una expresión, con otra expresión dentro de los
corchetes, buscará el elemento en la expresión de la izquierda que corresponda
al  <em>índice</em> dado por la expresión en corchetes.</p>
<p id="array_indexing"><a class=p_ident id="p_k/YYH/xvvI" href="#p_k/YYH/xvvI"></a>El primer índice de un arreglo es cero, no uno. Así que el primer elemento puede
leerse usando <code>listaDeNumeros[0]</code>. Si no tienes antecedentes en programación,
acostumbrarte a esta convención puede tomarte algún tiempo. Pero el
conteo con base cero tiene una larga tradición en tecnología y mientras la
convención se siga de manera consistente (que se ha hecho en Javascript),
funciona bien.</p>
<h2 id="properties"><a class=h_ident id="h_jddsYRbSVf" href="#h_jddsYRbSVf"></a>Propiedades</h2>
<p><a class=p_ident id="p_QWfY9lqvUg" href="#p_QWfY9lqvUg"></a>Hemos visto algunas expresiones
sospechosas como <code>myString.length</code> (para obtener la longitud de una cadena) y
<code>Math.max</code> (la función máximo) en ejemplos pasados. Estas son expresiones que
acceden una <em>propiedad</em> de algún valor. En el primer caso, accedemos a la
propiedad <code>length</code> de el valor en <code>myString</code>. En el segundo, accedemos a la
propiedad llamada <code>max</code> en el objeto <code>Math</code> (que es una colección de valores y
funciones relacionadas con las matemáticas).</p>
<p><a class=p_ident id="p_+scqPh9V5v" href="#p_+scqPh9V5v"></a>Casi todos los valores de JavaScript tienen
propiedades. Las excepciones son <code>null</code> y <code>undefined</code>. Si intentas acceder una
propiedad de alguno de estos valores inválidos recibirás un error.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_B83MTxU7nK" href="#c_B83MTxU7nK"></a><span class="cm-atom">null</span>.<span class="cm-property">length</span>;
<span class="cm-comment">// → TypeError: Cannot read property 'length' of null</span></pre>
<p><a class=p_ident id="p_7d7s0A0x5C" href="#p_7d7s0A0x5C"></a>Las dos maneras comunes de acceder a propiedades
en Javascript son con un punto y con corchetes. Ambas <code>valor.x</code> y <code>valor[x]</code>
acceden a una propiedad en <code>valor</code>, pero no necesariamente la misma propiedad.
La diferencia radica en cómo se interpreta <code>x</code>. Cuando usamos un punto, la parte
después del punto debe ser un nombre de variable válido y nombra de manera
directa a la propiedad. Cuando usamos corchetes, la expresión dentro de los
corchetes es <em>evaluada</em> para obtener el nombre de la propiedad. Mientras que
<code>valor.x</code> busca la propiedad de <code>valor</code> llamada “x”, <code>valor[x]</code> intenta evaluar
la expresión <code>x</code> y usa el resultado como el nombre de la propiedad.</p>
<p><a class=p_ident id="p_c9PE09Ekfb" href="#p_c9PE09Ekfb"></a>Así que si sabes que la propiedad que te interesa se llama “length”, usas
<code>valor.length</code>. Si deseas extraer la propiedad nombrada por el valor almacenado
en la variable <code>i</code>, usas <code>valor[i]</code>. Y debido a que el nombre de las propiedades
puede ser cualquier cadena, si quieres accesar una propiedad llamada “2” o
“Fulano”, debes utilizar corchetes:<code>valor[2]</code> or <code>valor["Fulano de Tal"]</code>. Así lo
harías incluso si conoces el nombre preciso de la propiedad de antemano, ya que
ni “2” ni “Fulano de Tal” son nombres válidos de variables y por lo tanto no puede
accederse a traves de la notación con punto.</p>
<p><a class=p_ident id="p_wz990jz07L" href="#p_wz990jz07L"></a>Los elementos en un arreglo se almacenan en propiedades. Debido a que los
nombres de estas propiedades son números y usualmente necesitamos obtener su
nombre de una variable, tenemos que usar la sintaxis de corchetes para accesarlos.
La propiedad <code>length</code> (longitud) de un arreglo nos dice cuantos elementos contiene. Este
nombre de propiedad es un nombre de variable válido, y conocemos su nombre por
anticipado, así que para encontrar la longitud de un arreglo, comúnmente
escribiremos <code>arreglo.length</code> ya que es más fácil de escribir que <code>arreglo["length"]</code>.</p>
<h2 id="methods"><a class=h_ident id="h_OYddlNFqr1" href="#h_OYddlNFqr1"></a>Métodos</h2>
<p><a class=p_ident id="p_VI/iacvm4D" href="#p_VI/iacvm4D"></a>Ambos objetos, las cadenas y
los arreglos contienen, adicionalmente a la propiedad <code>length</code> (longitud), varias
propiedades que refieren a valores que son funciones.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_4uDA4DT8/Q" href="#c_4uDA4DT8/Q"></a><span class="cm-keyword">var</span> <span class="cm-variable">doh</span> <span class="cm-operator">=</span> <span class="cm-string">"Doh"</span>;
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-keyword">typeof</span> <span class="cm-variable">doh</span>.<span class="cm-property">toUpperCase</span>);
<span class="cm-comment">// → function</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">doh</span>.<span class="cm-property">toUpperCase</span>());
<span class="cm-comment">// → DOH</span></pre>
<p><a class=p_ident id="p_9XCMFPbv3s" href="#p_9XCMFPbv3s"></a>Todas las cadenas tienen una propiedad <code>toUpperCase</code>. Cuando es invocada,
regresará una copia de la cadena en la que todas las letras han sido convertidas
a mayúsculas. También existe <code>toLowerCase</code>. Puedes adivinar que es lo que hace.</p>
<p><a class=p_ident id="p_cz5IB/Jm0K" href="#p_cz5IB/Jm0K"></a>Es interesante que, aunque la función <code>toUpperCase</code> no
recibe ningún argumento, delaguna forma accede a la cadena <code>"Doh"</code>, el
valor en que se llamó la función. Esto funciona como se describe en
el <a href="06_object.html#obj_methods">Capítulo 6</a>.</p>
<p><a class=p_ident id="p_weOH3L+kzO" href="#p_weOH3L+kzO"></a>Las propiedades que contienen funciones genralmente son llamadas <em>métodos</em>
del valor al que pertenecen. Así, "<code>toUpperCase</code> es un método de una cadena".</p>
<p id="array_methods"><a class=p_ident id="p_BM3xpho82E" href="#p_BM3xpho82E"></a>Este ejemplo demuestra
algunos métodos que los objetos arrays tienen:</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_Lr0RiBqCp8" href="#c_Lr0RiBqCp8"></a><span class="cm-keyword">var</span> <span class="cm-variable">mack</span> <span class="cm-operator">=</span> [];
<span class="cm-variable">mack</span>.<span class="cm-property">push</span>(<span class="cm-string">"Mack"</span>);
<span class="cm-variable">mack</span>.<span class="cm-property">push</span>(<span class="cm-string">"the"</span>, <span class="cm-string">"Knife"</span>);
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">mack</span>);
<span class="cm-comment">// → ["Mack", "the", "Knife"]</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">mack</span>.<span class="cm-property">join</span>(<span class="cm-string">" "</span>));
<span class="cm-comment">// → Mack the Knife</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">mack</span>.<span class="cm-property">pop</span>());
<span class="cm-comment">// → Knife</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">mack</span>);
<span class="cm-comment">// → ["Mack", "the"]</span></pre>
<p><a class=p_ident id="p_GQx7JMtCbY" href="#p_GQx7JMtCbY"></a>El método <code>push</code> puede ser usado para añadir valores al final de un
array. El método <code>pop</code> hace lo contrario: elimina el valor al final
del array y lo regresa. Un array de cadenas puede ser transformado a
una sola cadena con el método <code>join</code>. El argumento que se da a <code>join</code>
determina el texto que se usa entre los elementos del array.</p>
<h2><a class=h_ident id="h_WSNvRpk0Lx" href="#h_WSNvRpk0Lx"></a>Objetos</h2>
<p><a class=p_ident id="p_J6k8j2Njng" href="#p_J6k8j2Njng"></a>De
regreso con el hombre ardilla. Un conjunto de entradas diaras de registro
pueden ser representadas como un array. Pero las entradas no consisten
de sólo un número o una cadena, cada entrada necesita guarda una lista de
actividades y un valor Booleano que indica si Jacques se convirtió en
ardilla. Idealmente, nos gustaría agrupar estos valores juntos en un solo
valor y poner estos valores agrupados en un array de entradas del registro.</p>
<p><a class=p_ident id="p_oeA3xDAjHt" href="#p_oeA3xDAjHt"></a>Los valores del tipo <em>objeto</em> son colecciones arbitrarias
de propiedades, y podemos añadir o remover estas propiedades a placer.
Una manera de crear un objeto es usando la notación de llaves.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_3PcXIAo68I" href="#c_3PcXIAo68I"></a><span class="cm-keyword">var</span> <span class="cm-variable">dia1</span> <span class="cm-operator">=</span> {
  <span class="cm-property">ardilla</span>: <span class="cm-atom">false</span>,
  <span class="cm-property">eventos</span>: [<span class="cm-string">"trabajo"</span>, <span class="cm-string">"toqué un arbol"</span>, <span class="cm-string">"pizza"</span>, <span class="cm-string">"correr"</span>,
           <span class="cm-string">"televisión"</span>]
};
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">dia1</span>.<span class="cm-property">ardilla</span>);
<span class="cm-comment">// → false</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">dia1</span>.<span class="cm-property">lobo</span>);
<span class="cm-comment">// → undefined</span>
<span class="cm-variable">dia1</span>.<span class="cm-property">lobo</span> <span class="cm-operator">=</span> <span class="cm-atom">false</span>;
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">dia1</span>.<span class="cm-property">lobo</span>);
<span class="cm-comment">// → false</span></pre>
<p><a class=p_ident id="p_+1uD2vJsVI" href="#p_+1uD2vJsVI"></a>Dentro
de las llaves, podemos dar una lista de propiedades separadas por comas.
Cada propiedad está escritra como un nombre seguido por dos puntos, seguidos
pos una expresión que le asigna el valor a esa propiedad. Los espacios
y saltos de línea no son afectan. Cunado un objeto tiene múltiples líneas,
indentarlas como en el ejemplo previo mejora la legibilidad. Las propiedades
que tengan nombres que no sean nombres de variable válidos o números válidos
tienen que estar entrecomilladas.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_lgCb8CmCs5" href="#c_lgCb8CmCs5"></a><span class="cm-keyword">var</span> <span class="cm-variable">descripciones</span> <span class="cm-operator">=</span> {
  <span class="cm-property">trabajo</span>: <span class="cm-string">"Fui al trabajo"</span>,
  <span class="cm-string cm-property">"toqué un arbol"</span>: <span class="cm-string">"Toqué el arbol del vecino"</span>
};</pre>
<p><a class=p_ident id="p_Wc7iSsORLR" href="#p_Wc7iSsORLR"></a>Esto significa que las llaves tienen <em>dos</em> significados en JavaScript.
Al principio de una sentencia, empiezan un bloque de sentencia. En cualquier
otra posición, describen un objeto. Afortunadamente, casi nunca es útil
empezar una sentencia con un objeto declarado con llaves, y en programas típicos,
no hay ambigüedad entre esos dos usos.</p>
<p><a class=p_ident id="p_7W0tQwA2Xp" href="#p_7W0tQwA2Xp"></a>Al leer una propiedad que no existe se produce el
valor <code>undefined</code>, es lo que pasa la primera vez que intentamos leer
la propiedad <code>lobo</code> en el ejemplo previo.</p>
<p><a class=p_ident id="p_Jzed9fnBmS" href="#p_Jzed9fnBmS"></a>Es posible asignar
un valor a una expresión de propiedad con el operador <code>=</code>. Esto
reemplazará el valor de la propiedad si ya existía o creará una nueva propiedad
en el objeto si no.</p>
<p><a class=p_ident id="p_PgI7/wYhcJ" href="#p_PgI7/wYhcJ"></a>Para regresar brevemente a nuestro
modelo de tentáculos para asignaciones de variable, la asignación de
propiedades es parecida. Estas <em>agarran</em> valores, pero otras variables y
propiedades pudieran estar agarrando estos mismos valores. Puedes pensar
que los objetos son pulpos con un número indefinido de tentáculos, cada uno
de los cuales tiene un nombre escrito en él.</p>
<div class="image">
  <img src="img/octopus-object.jpg" alt="Representación de un objeto de un artista.">
</div>
<p><a class=p_ident id="p_TQ544dlM35" href="#p_TQ544dlM35"></a>El operador <code>delete</code> le corta un
tentáculo a este pulpo. Es un operador unario que, cuando es aplicado a una
expresión de acceso a una propiedad, eliminará la propiedad nombrada del objeto.
Esto no es algo que se haga comúnmente, pero es posible.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_iBFU/mrO8m" href="#c_iBFU/mrO8m"></a><span class="cm-keyword">var</span> <span class="cm-variable">unObjeto</span> <span class="cm-operator">=</span> {<span class="cm-property">izq</span>: <span class="cm-number">1</span>, <span class="cm-property">der</span>: <span class="cm-number">2</span>};
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">unObjeto</span>.<span class="cm-property">izq</span>);
<span class="cm-comment">// → 1</span>
<span class="cm-keyword">delete</span> <span class="cm-variable">unObjeto</span>.<span class="cm-property">izq</span>;
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">unObjeto</span>.<span class="cm-property">izq</span>);
<span class="cm-comment">// → undefined</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"izq"</span> <span class="cm-keyword">in</span> <span class="cm-variable">unObjeto</span>);
<span class="cm-comment">// → false</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"der"</span> <span class="cm-keyword">in</span> <span class="cm-variable">unObjeto</span>);
<span class="cm-comment">// → true</span></pre>
<p><a class=p_ident id="p_vFrSSKA7O4" href="#p_vFrSSKA7O4"></a>El operador binario
<code>in</code>, cuando se aplica a una cadena y un objeto, devuelve un valor Booleano
que indica si el objeto tiene esa propiedad. La diferencia entre asignarle
<code>undefined</code> a una propiedad y borrarla de verdad es que, en el primer caso,
el objeto aún <em>tiene</em> la propiedad (simplemente no tiene un valor muy interesante),
mientras que en el segundo caso, la propiedad no está presente e <code>in</code> devolverá
<code>false</code>.</p>
<p><a class=p_ident id="p_cFfhmDu4tJ" href="#p_cFfhmDu4tJ"></a>Los arrays son solamente un tipo de objeto
especializado en almacenar secuencias de cosas. Si evaluas <code>typeof [1, 2]</code>,
se prodcue <code>"object"</code>. Puedes verlos como pulpos largos y planos con
todos sus tentáculos en una fila limpia, etiquetados con números.</p>
<div class="image">
  <img src="img/octopus-array.jpg" alt="Artist's representation of an array">
</div>
<p><a class=p_ident id="p_M/klGP/xw3" href="#p_M/klGP/xw3"></a>Así que podemos representar el
diario de Jacques coomo un array de objetos.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_bfbU1yyn3q" href="#c_bfbU1yyn3q"></a><span class="cm-keyword">var</span> <span class="cm-variable">diario</span> <span class="cm-operator">=</span> [
  {<span class="cm-property">eventos</span>: [<span class="cm-string">"trabajo"</span>, <span class="cm-string">"tocar un arbol"</span>, <span class="cm-string">"pizza"</span>,
            <span class="cm-string">"correr"</span>, <span class="cm-string">"televisión"</span>],
   <span class="cm-property">ardilla</span>: <span class="cm-atom">false</span>},
  {<span class="cm-property">eventos</span>: [<span class="cm-string">"trabajo"</span>, <span class="cm-string">"helado"</span>, <span class="cm-string">"coliflor"</span>,
            <span class="cm-string">"lasagna"</span>, <span class="cm-string">"tocar un arbol"</span>, <span class="cm-string">"lavarse los dientes"</span>],
   <span class="cm-property">ardilla</span>: <span class="cm-atom">false</span>},
  {<span class="cm-property">eventos</span>: [<span class="cm-string">"fin de seamana"</span>, <span class="cm-string">"bicicleta"</span>, <span class="cm-string">"descanso"</span>,
            <span class="cm-string">"cacahuates"</span>, <span class="cm-string">"cerveza"</span>],
   <span class="cm-property">ardilla</span>: <span class="cm-atom">true</span>},
  <span class="cm-comment">/* y continúa... */</span>
];</pre>
<h2><a class=h_ident id="h_/KYBvi2eEd" href="#h_/KYBvi2eEd"></a>Mutabilidad</h2>
<p><a class=p_ident id="p_q4A/RAizOl" href="#p_q4A/RAizOl"></a>Nos meteremos en la programación de verdad pronto. Pero primero,
hay una última pieza de teoría que entender.</p>
<p><a class=p_ident id="p_Kn7fupaHCZ" href="#p_Kn7fupaHCZ"></a>Hemos
visto que los valores objeto pueden ser modificados. Los tipos de
valores de los que platicamos en capítulos anteriores, como números,
cadenas, Booleanos son todos <em>inmutables</em>; es imposible cambiar un
valor existente de esos tipos. Puedes combinarlos y derivar nuevos valores de
ellos, pero cuando tomas un valor cadena específico, ese valor siempre
permanecerá igual. El texto que está adentro no puede ser cambiado. Si
tienes una referencia a una cadena que contiene <code>"cat"</code>, no se posible
para el código cambiar un caráctes en <em>esa</em> cadena para hacerlo decir <code>"rat"</code>.</p>
<p><a class=p_ident id="p_HFAgIyb6gX" href="#p_HFAgIyb6gX"></a>Con los objeto, por otro lado, el contenido de un valor <em>puede</em> ser
modificado al cambiar sus propiedades.</p>
<p><a class=p_ident id="p_ulxBQ5Ge7V" href="#p_ulxBQ5Ge7V"></a>Cuando tenemos dos
números,, 120 y 120, podemos considerar que son precisamente el mismo número
independientemente si se refieren o no a los mismos bits físicos. Pero
con los objetos, hay una diferencia entre tener la dos referencias al mismo objeto y tener dos objetos que contienen las mismas propiedades.
Considera el siguiente código:</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_SY037Zq/5A" href="#c_SY037Zq/5A"></a><span class="cm-keyword">var</span> <span class="cm-variable">objeto1</span> <span class="cm-operator">=</span> {<span class="cm-property">valor</span>: <span class="cm-number">10</span>};
<span class="cm-keyword">var</span> <span class="cm-variable">objeto2</span> <span class="cm-operator">=</span> <span class="cm-variable">objeto1</span>;
<span class="cm-keyword">var</span> <span class="cm-variable">objeto3</span> <span class="cm-operator">=</span> {<span class="cm-property">valor</span>: <span class="cm-number">10</span>};

<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">objeto1</span> <span class="cm-operator">==</span> <span class="cm-variable">objeto2</span>);
<span class="cm-comment">// → true</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">objeto1</span> <span class="cm-operator">==</span> <span class="cm-variable">objeto3</span>);
<span class="cm-comment">// → false</span>

<span class="cm-variable">objeto1</span>.<span class="cm-property">valor</span> <span class="cm-operator">=</span> <span class="cm-number">15</span>;
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">objeto2</span>.<span class="cm-property">valor</span>);
<span class="cm-comment">// → 15</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">objeto3</span>.<span class="cm-property">valor</span>);
<span class="cm-comment">// → 10</span></pre>
<p><a class=p_ident id="p_kLu4a1N+IO" href="#p_kLu4a1N+IO"></a>Las variables
<code>objeto1</code> y <code>objeto2</code> agarran el <em>mismo</em> objeto, ésta es la razón
de que al cambiar <code>objeto1</code> también se cambia el valor del <code>objeto2</code>.
La variable <code>objeto3</code> apunta a un objeto diferente, que inicialmente
contiene las mismas propiedades que el <code>objeto1</code> pero vive una vida
separada.</p>
<p><a class=p_ident id="p_jb/zBwcdL3" href="#p_jb/zBwcdL3"></a>El operador <code>==</code> de JavaScript, cuando compara objetos
regresará <code>true</code> sólo si los dos objetos son precisamente el mismo
valor. Comparar diferentes objetos regresará <code>false</code>, incluso si
tienen contenidos idénticos. No existe comparación "profunda" construida en
JavaScript, la cual se basa en el contenido de los objetos, pero puedes
escribirla tú mismo (que será uno de los
<a href="04_data.html#exercise_deep_compare">ejercicios</a> al final de este capítulo).</p>
<h2><a class=h_ident id="h_yM11hOP1fJ" href="#h_yM11hOP1fJ"></a>El registro del licántropo</h2>
<p><a class=p_ident id="p_8/0TGF5auf" href="#p_8/0TGF5auf"></a>Así,
Jacques inicia su intérprete de JavaScript y configura el entorno
que necesita para llevar su diario.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_9th6Xkmi9j" href="#c_9th6Xkmi9j"></a><span class="cm-keyword">var</span> <span class="cm-variable">diario</span> <span class="cm-operator">=</span> [];

<span class="cm-keyword">function</span> <span class="cm-variable">agregarEntrada</span>(<span class="cm-def">eventos</span>, <span class="cm-def">meVolviArdilla</span>) {
  <span class="cm-variable">diario</span>.<span class="cm-property">push</span>({
    <span class="cm-property">eventos</span>: <span class="cm-variable-2">eventos</span>,
    <span class="cm-property">ardilla</span>: <span class="cm-variable-2">meVolviArdilla</span>
  });
}</pre>
<p><a class=p_ident id="p_NqldmGIIn/" href="#p_NqldmGIIn/"></a>Y después, cada noche a las 10, o algunas veces la mañana siguiente,
después de haber bajado de la parte superior de su librero, registra
el día.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_efshPU6xpf" href="#c_efshPU6xpf"></a><span class="cm-variable">agregarEntrada</span>([<span class="cm-string">"trabajo"</span>, <span class="cm-string">"toqué un árbol"</span>, <span class="cm-string">"pizza"</span>, <span class="cm-string">"correr"</span>,
          <span class="cm-string">"televisión"</span>], <span class="cm-atom">false</span>);
<span class="cm-variable">agregarEntrada</span>([<span class="cm-string">"trabajo"</span>, <span class="cm-string">"helado"</span>, <span class="cm-string">"coliflor"</span>, <span class="cm-string">"lasagna"</span>,
          <span class="cm-string">"toqué un árbol"</span>, <span class="cm-string">"me lavé los dientes"</span>], <span class="cm-atom">false</span>);
<span class="cm-variable">agregarEntrada</span>([<span class="cm-string">"fin de semana"</span>, <span class="cm-string">"bicicleta"</span>, <span class="cm-string">"descanso"</span>, <span class="cm-string">"cacachuates"</span>,
          <span class="cm-string">"cerveza"</span>], <span class="cm-atom">true</span>);</pre>
<p><a class=p_ident id="p_ITwYvwUuID" href="#p_ITwYvwUuID"></a>Una vez que tiene suficientes datos, quiere calcular la correlación
entre su ardillamiento y cada uno de los eventos e, idealmente, aprender
algo útil de esas correlaciones.</p>
<p><a class=p_ident id="p_Tdp8x+hDZh" href="#p_Tdp8x+hDZh"></a>La <em>Correlación</em> es una medida de dependencia entre
variables (“variables” en el sentido de la estadística, no en el de
JavaScript). Es expresada usualmente como un coeficiente que va del -1 al
1. Una correlación de 0 significa que las variables no están relacionadas, mientras
que una correlación de uno indica que están perfectamente relacionadas: si conoces una,
entonces conoces la otra. El uno negativo también significa que están perfectamente
relacionadas pero que son opuestas, cuando una es verdadera, la otra es falsa.</p>
<p><a class=p_ident id="p_3jzk2lT9ms" href="#p_3jzk2lT9ms"></a> Para variables binarias (Booleanas), el coeficiente <em>phi</em>
(<em>ϕ</em>) da una buena medida de correlación y es relativamente fácil de calcular.
Para calcular <em>ϕ</em> necesitamos una tabla <em>n</em> que contine el número de veces
que varias combinaciones de variables fueron observadas. Por ejemplo, podríamos
tomar el evento de comer pizza y ponerlo en la tabla de la siguiente manera:</p>
<div class="image">
  <img src="img/pizza-squirrel.svg" alt="Comer pizza vs convertirse en ardilla.">
</div>
<p><a class=p_ident id="p_Pp3q5u7ieE" href="#p_Pp3q5u7ieE"></a><em>ϕ</em> puede ser calculado usando la siguiente fórmula, en donde <em>n</em> se refiere a la
tabla:</p>
<div>
<style scoped="scoped">sub { font-size: 60%; }</style>
<table style="border-collapse: collapse; margin-left: 1em;"><tr>
  <td style="vertical-align: middle"><em>ϕ</em> =</td>
  <td style="padding-left: .5em">
    <div style="border-bottom: 1px solid black; padding: 0 7px;">n<sub>11</sub>n<sub>00</sub> - n<sub>10</sub>n<sub>01</sub></div>
    <div style="padding: 0 7px;">√<span style="border-top: 1px solid black; position: relative; top: 2px;">
      <span style="position: relative; top: -4px">n<sub>1•</sub>n<sub>0•</sub>n<sub>•1</sub>n<sub>•0</sub></span>
    </span></div>
  </td>
</tr></table>
</div>
<p><a class=p_ident id="p_8O75zvTqw1" href="#p_8O75zvTqw1"></a>La notación <em>n</em><sub>01</sub> indica el
número de medidas en el que la primer vairiable (ardillificación) es falsa (0)
y la segunda variable (pizza) es verdadera (1). En este ejemplo, <em>n</em><sub>01</sub> es 9.</p>
<p><a class=p_ident id="p_6JDZ7pY+nU" href="#p_6JDZ7pY+nU"></a>El valor <em>n</em><sub>1•</sub> se refiere a la suma
de todas las medidas en donde la primera variable es verdadera, que es 5 en la tabla de
ejemplo. De la misma manera, <em>n</em><sub>•0</sub>
se refiere a la suma de medidas en donde la segunda variable es falsa.</p>
<p><a class=p_ident id="p_2RxEbX413+" href="#p_2RxEbX413+"></a> Así que para la tabla de la pizza,
la parte de arriba de la línea de división (el dividendo) sería 1×76 - 4×9 = 40,
y la parte de debajo de la línea (el divisor) sería la raíz cuadrada de
5×85×10×80, o √340000. Esto da como resultado
<em>ϕ</em> ≈ 0.069, que es muy pequeño. Comer pizza no parece tener influencia en las transformaciones.</p>
<h2><a class=h_ident id="h_SBM8Hsf97Y" href="#h_SBM8Hsf97Y"></a>Calculando correlaciones</h2>
<p><a class=p_ident id="p_Qw3t7bWwW/" href="#p_Qw3t7bWwW/"></a>Podemos representar una
tabla de dos por dos en JavaScript con un array de 4 elementos
(<code>[76, 9, 4, 1]</code>). Podríamos también usar otras representaciones, como
un array que contenga dos arrays de dos elementos cada uno (<code>[[76, 9], [4, 1]]</code>) o como
un objeto con nombre de propiedades como <code>"11"</code> y <code>"01"</code>, pero el array
plano es simple y hace que las expresiones de acceso a la tabla sean
convenientemente cortas. Interpretaremos los índices del array como
un número binario de dos bits, en donde el dígito más a la izquierda
(el más siginificativo) se refiere a la variable de la ardilla y el más a
la derecha (menos significativo) se refiere a la variable del evento. Por ejemplo,
el número binario <code>10</code> se refiere al caso en que Jacques se convirtió en
ardilla, pero el evento (digamos, "pizza"), no ocurrió. Esto pasó 4 veces. Y como
el binario <code>10</code> es 2 en notación decimal, guardaremos ese número en el índice 2
del array.</p>
<p><a class=p_ident id="p_napfsNS5sk" href="#p_napfsNS5sk"></a>This is the function that
computes the <em>ϕ</em> coefficient from such an array:</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_kurq8z94si" href="#c_kurq8z94si"></a><span class="cm-keyword">function</span> <span class="cm-variable">phi</span>(<span class="cm-def">table</span>) {
  <span class="cm-keyword">return</span> (<span class="cm-variable-2">table</span>[<span class="cm-number">3</span>] <span class="cm-operator">*</span> <span class="cm-variable-2">table</span>[<span class="cm-number">0</span>] <span class="cm-operator">-</span> <span class="cm-variable-2">table</span>[<span class="cm-number">2</span>] <span class="cm-operator">*</span> <span class="cm-variable-2">table</span>[<span class="cm-number">1</span>]) <span class="cm-operator">/</span>
    <span class="cm-variable">Math</span>.<span class="cm-property">sqrt</span>((<span class="cm-variable-2">table</span>[<span class="cm-number">2</span>] <span class="cm-operator">+</span> <span class="cm-variable-2">table</span>[<span class="cm-number">3</span>]) <span class="cm-operator">*</span>
              (<span class="cm-variable-2">table</span>[<span class="cm-number">0</span>] <span class="cm-operator">+</span> <span class="cm-variable-2">table</span>[<span class="cm-number">1</span>]) <span class="cm-operator">*</span>
              (<span class="cm-variable-2">table</span>[<span class="cm-number">1</span>] <span class="cm-operator">+</span> <span class="cm-variable-2">table</span>[<span class="cm-number">3</span>]) <span class="cm-operator">*</span>
              (<span class="cm-variable-2">table</span>[<span class="cm-number">0</span>] <span class="cm-operator">+</span> <span class="cm-variable-2">table</span>[<span class="cm-number">2</span>]));
}

<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">phi</span>([<span class="cm-number">76</span>, <span class="cm-number">9</span>, <span class="cm-number">4</span>, <span class="cm-number">1</span>]));
<span class="cm-comment">// → 0.068599434</span></pre>
<p><a class=p_ident id="p_25QRmcB8ci" href="#p_25QRmcB8ci"></a>This is simply a direct
translation of the <em>ϕ</em> formula into JavaScript. <code>Math.sqrt</code> is the
square root function, as provided by the <code>Math</code> object in a standard
JavaScript environment. We have to sum two fields from the table to
get fields like n<sub>1•</sub> because
the sums of rows or columns are not stored directly in our data
structure.</p>
<p><a class=p_ident id="p_0u/DATumDu" href="#p_0u/DATumDu"></a>Jacques kept his journal for three months. The
resulting data set is available in the coding sandbox for this
chapter,
where it is stored in the <code>JOURNAL</code> variable, and in a downloadable
<a href="http://eloquentjavascript.net/code/jacques_journal.js">file</a>.</p>
<p><a class=p_ident id="p_sM+4QT8FKs" href="#p_sM+4QT8FKs"></a>To extract a two-by-two
table for a specific event from this journal, we must loop over
all the entries and tally up how many times the event occurs in
relation to squirrel transformations.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_zCS39l9qoi" href="#c_zCS39l9qoi"></a><span class="cm-keyword">function</span> <span class="cm-variable">hasEvent</span>(<span class="cm-def">event</span>, <span class="cm-def">entry</span>) {
  <span class="cm-keyword">return</span> <span class="cm-variable-2">entry</span>.<span class="cm-property">events</span>.<span class="cm-property">indexOf</span>(<span class="cm-variable-2">event</span>) <span class="cm-operator">!=</span> <span class="cm-operator">-</span><span class="cm-number">1</span>;
}

<span class="cm-keyword">function</span> <span class="cm-variable">tableFor</span>(<span class="cm-def">event</span>, <span class="cm-def">journal</span>) {
  <span class="cm-keyword">var</span> <span class="cm-def">table</span> <span class="cm-operator">=</span> [<span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>];
  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">journal</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>) {
    <span class="cm-keyword">var</span> <span class="cm-def">entry</span> <span class="cm-operator">=</span> <span class="cm-variable-2">journal</span>[<span class="cm-variable-2">i</span>], <span class="cm-def">index</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;
    <span class="cm-keyword">if</span> (<span class="cm-variable">hasEvent</span>(<span class="cm-variable-2">event</span>, <span class="cm-variable-2">entry</span>)) <span class="cm-variable-2">index</span> <span class="cm-operator">+=</span> <span class="cm-number">1</span>;
    <span class="cm-keyword">if</span> (<span class="cm-variable-2">entry</span>.<span class="cm-property">squirrel</span>) <span class="cm-variable-2">index</span> <span class="cm-operator">+=</span> <span class="cm-number">2</span>;
    <span class="cm-variable-2">table</span>[<span class="cm-variable-2">index</span>] <span class="cm-operator">+=</span> <span class="cm-number">1</span>;
  }
  <span class="cm-keyword">return</span> <span class="cm-variable-2">table</span>;
}

<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">tableFor</span>(<span class="cm-string">"pizza"</span>, <span class="cm-variable">JOURNAL</span>));
<span class="cm-comment">// → [76, 9, 4, 1]</span></pre>
<p><a class=p_ident id="p_3pgyJn7mEy" href="#p_3pgyJn7mEy"></a>The <code>hasEvent</code> function tests
whether an entry contains a given event. Arrays have an <code>indexOf</code>
method that tries to find a given value (in this case, the event name)
in the array and returns the index at which it was found or -1 if it
wasn&#8217;t found. So if the call to <code>indexOf</code> doesn&#8217;t return -1, then we
know the event was found in the entry.</p>
<p><a class=p_ident id="p_6jCcm4ltfJ" href="#p_6jCcm4ltfJ"></a>The body of the loop in <code>tableFor</code> figures
out which box in the table each journal entry falls into by checking
whether the entry contains the specific event it&#8217;s interested in and
whether the event happens alongside a squirrel incident. The loop then
adds one to the number in the array that corresponds to this box on
the table.</p>
<p><a class=p_ident id="p_PId7X0fpkS" href="#p_PId7X0fpkS"></a>We now have the tools we need to compute individual correlations.
The only step remaining is to find a correlation for every type of
event that was recorded and see whether anything stands out. But how
should we store these correlations once we compute them?</p>
<h2><a class=h_ident id="h_mrW9RQxlGk" href="#h_mrW9RQxlGk"></a>Objects as maps</h2>
<p><a class=p_ident id="p_IdpwDMsKm8" href="#p_IdpwDMsKm8"></a>One possible way is to store
all the correlations in an array, using objects with <code>name</code> and
<code>value</code> properties. But that makes looking up the correlation for a
given event somewhat cumbersome: you&#8217;d have to loop over the whole
array to find the object with the right <code>name</code>. We could wrap this
lookup process in a function, but we would still be writing more code,
and the computer would be doing more work than necessary.</p>
<p id="object_map"><a class=p_ident id="p_cZSsd9wDlN" href="#p_cZSsd9wDlN"></a>A better way is to use object properties named after the
event types. We can use the square bracket access notation to create
and read the properties and can use the <code>in</code> operator to test whether
a given property exists.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_3/W5rqFVOs" href="#c_3/W5rqFVOs"></a><span class="cm-keyword">var</span> <span class="cm-variable">map</span> <span class="cm-operator">=</span> {};
<span class="cm-keyword">function</span> <span class="cm-variable">storePhi</span>(<span class="cm-def">event</span>, <span class="cm-def">phi</span>) {
  <span class="cm-variable">map</span>[<span class="cm-variable-2">event</span>] <span class="cm-operator">=</span> <span class="cm-variable-2">phi</span>;
}

<span class="cm-variable">storePhi</span>(<span class="cm-string">"pizza"</span>, <span class="cm-number">0.069</span>);
<span class="cm-variable">storePhi</span>(<span class="cm-string">"toqué un árbol"</span>, <span class="cm-operator">-</span><span class="cm-number">0.081</span>);
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"pizza"</span> <span class="cm-keyword">in</span> <span class="cm-variable">map</span>);
<span class="cm-comment">// → true</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">map</span>[<span class="cm-string">"touched tree"</span>]);
<span class="cm-comment">// → -0.081</span></pre>
<p><a class=p_ident id="p_OlrE0O0+IT" href="#p_OlrE0O0+IT"></a>A <em>map</em> is a way to go from values in one
domain (in this case, event names) to corresponding values in another
domain (in this case, <em>ϕ</em> coefficients).</p>
<p><a class=p_ident id="p_Geo6ELctAH" href="#p_Geo6ELctAH"></a>There are a few potential problems with using objects like this, which
we will discuss in <a href="06_object.html#prototypes">Chapter 6</a>, but for
the time being, we won&#8217;t worry about those.</p>
<p><a class=p_ident id="p_esSmj3VTX0" href="#p_esSmj3VTX0"></a>What if
we want to find all the events for which we have stored a coefficient?
The properties don&#8217;t form a predictable series, like they would in an
array, so we cannot use a normal <code>for</code> loop. JavaScript provides a
loop construct specifically for going over the properties of an
object. It looks a little like a normal <code>for</code> loop but distinguishes
itself by the use of the word <code>in</code>.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_6gN7jQD267" href="#c_6gN7jQD267"></a><span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">event</span> <span class="cm-keyword">in</span> <span class="cm-variable">map</span>)
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"The correlation for '"</span> <span class="cm-operator">+</span> <span class="cm-variable">event</span> <span class="cm-operator">+</span>
              <span class="cm-string">"' is "</span> <span class="cm-operator">+</span> <span class="cm-variable">map</span>[<span class="cm-variable">event</span>]);
<span class="cm-comment">// → The correlation for 'pizza' is 0.069</span>
<span class="cm-comment">// → The correlation for 'touched tree' is -0.081</span></pre>
<h2 id="analysis"><a class=h_ident id="h_Lg5n7mjqw/" href="#h_Lg5n7mjqw/"></a>The final analysis</h2>
<p><a class=p_ident id="p_o0qm2V9nGm" href="#p_o0qm2V9nGm"></a>To find all the types of events that are present in the
data set, we simply process each entry in turn and then loop over the
events in that entry. We keep an object <code>phis</code> that has correlation
coefficients for all the event types we have seen so far. Whenever we
run across a type that isn&#8217;t in the <code>phis</code> object yet, we compute its
correlation and add it to the object.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_XWKz7pnQgN" href="#c_XWKz7pnQgN"></a><span class="cm-keyword">function</span> <span class="cm-variable">gatherCorrelations</span>(<span class="cm-def">journal</span>) {
  <span class="cm-keyword">var</span> <span class="cm-def">phis</span> <span class="cm-operator">=</span> {};
  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">entry</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">entry</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">journal</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">entry</span><span class="cm-operator">++</span>) {
    <span class="cm-keyword">var</span> <span class="cm-def">events</span> <span class="cm-operator">=</span> <span class="cm-variable-2">journal</span>[<span class="cm-variable-2">entry</span>].<span class="cm-property">events</span>;
    <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">events</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>) {
      <span class="cm-keyword">var</span> <span class="cm-def">event</span> <span class="cm-operator">=</span> <span class="cm-variable-2">events</span>[<span class="cm-variable-2">i</span>];
      <span class="cm-keyword">if</span> (<span class="cm-operator">!</span>(<span class="cm-variable-2">event</span> <span class="cm-keyword">in</span> <span class="cm-variable-2">phis</span>))
        <span class="cm-variable-2">phis</span>[<span class="cm-variable-2">event</span>] <span class="cm-operator">=</span> <span class="cm-variable">phi</span>(<span class="cm-variable">tableFor</span>(<span class="cm-variable-2">event</span>, <span class="cm-variable-2">journal</span>));
    }
  }
  <span class="cm-keyword">return</span> <span class="cm-variable-2">phis</span>;
}

<span class="cm-keyword">var</span> <span class="cm-variable">correlations</span> <span class="cm-operator">=</span> <span class="cm-variable">gatherCorrelations</span>(<span class="cm-variable">JOURNAL</span>);
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">correlations</span>.<span class="cm-property">pizza</span>);
<span class="cm-comment">// → 0.068599434</span></pre>
<p><a class=p_ident id="p_XUj02Go7DR" href="#p_XUj02Go7DR"></a>Let&#8217;s see what came out.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_9yz0E9p7aB" href="#c_9yz0E9p7aB"></a><span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">event</span> <span class="cm-keyword">in</span> <span class="cm-variable">correlations</span>)
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">event</span> <span class="cm-operator">+</span> <span class="cm-string">": "</span> <span class="cm-operator">+</span> <span class="cm-variable">correlations</span>[<span class="cm-variable">event</span>]);
<span class="cm-comment">// → carrot:   0.0140970969</span>
<span class="cm-comment">// → exercise: 0.0685994341</span>
<span class="cm-comment">// → weekend:  0.1371988681</span>
<span class="cm-comment">// → bread:   -0.0757554019</span>
<span class="cm-comment">// → pudding: -0.0648203724</span>
<span class="cm-comment">// and so on...</span></pre>
<p><a class=p_ident id="p_TiI6dIjE18" href="#p_TiI6dIjE18"></a>Most correlations seem to lie close to zero. Eating
carrots, bread, or pudding apparently does not trigger
squirrel-lycanthropy. It <em>does</em> seem to occur somewhat more often on
weekends, however. Let&#8217;s filter the results to show only correlations
greater than 0.1 or less than -0.1.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_n5ah9P3y8e" href="#c_n5ah9P3y8e"></a><span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">event</span> <span class="cm-keyword">in</span> <span class="cm-variable">correlations</span>) {
  <span class="cm-keyword">var</span> <span class="cm-variable">correlation</span> <span class="cm-operator">=</span> <span class="cm-variable">correlations</span>[<span class="cm-variable">event</span>];
  <span class="cm-keyword">if</span> (<span class="cm-variable">correlation</span> <span class="cm-operator">></span> <span class="cm-number">0.1</span> <span class="cm-operator">||</span> <span class="cm-variable">correlation</span> <span class="cm-operator">&lt;</span> <span class="cm-operator">-</span><span class="cm-number">0.1</span>)
    <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">event</span> <span class="cm-operator">+</span> <span class="cm-string">": "</span> <span class="cm-operator">+</span> <span class="cm-variable">correlation</span>);
}
<span class="cm-comment">// → weekend:        0.1371988681</span>
<span class="cm-comment">// → brushed teeth: -0.3805211953</span>
<span class="cm-comment">// → candy:          0.1296407447</span>
<span class="cm-comment">// → work:          -0.1371988681</span>
<span class="cm-comment">// → spaghetti:      0.2425356250</span>
<span class="cm-comment">// → reading:        0.1106828054</span>
<span class="cm-comment">// → peanuts:        0.5902679812</span></pre>
<p><a class=p_ident id="p_V2ZEhvkhz3" href="#p_V2ZEhvkhz3"></a>A-ha! There are two factors whose correlation is clearly stronger
than the others. Eating peanuts has a strong positive effect on
the chance of turning into a squirrel, whereas brushing his teeth has
a significant negative effect.</p>
<p><a class=p_ident id="p_xpRHDuufcX" href="#p_xpRHDuufcX"></a>Interesting. Let&#8217;s try something.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_wPh8Dw9Oh6" href="#c_wPh8Dw9Oh6"></a><span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">JOURNAL</span>.<span class="cm-property">length</span>; <span class="cm-variable">i</span><span class="cm-operator">++</span>) {
  <span class="cm-keyword">var</span> <span class="cm-variable">entry</span> <span class="cm-operator">=</span> <span class="cm-variable">JOURNAL</span>[<span class="cm-variable">i</span>];
  <span class="cm-keyword">if</span> (<span class="cm-variable">hasEvent</span>(<span class="cm-string">"peanuts"</span>, <span class="cm-variable">entry</span>) <span class="cm-operator">&amp;&amp;</span>
     <span class="cm-operator">!</span><span class="cm-variable">hasEvent</span>(<span class="cm-string">"brushed teeth"</span>, <span class="cm-variable">entry</span>))
    <span class="cm-variable">entry</span>.<span class="cm-property">events</span>.<span class="cm-property">push</span>(<span class="cm-string">"peanut teeth"</span>);
}
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">phi</span>(<span class="cm-variable">tableFor</span>(<span class="cm-string">"peanut teeth"</span>, <span class="cm-variable">JOURNAL</span>)));
<span class="cm-comment">// → 1</span></pre>
<p><a class=p_ident id="p_WUlOiYWV3C" href="#p_WUlOiYWV3C"></a>Well, that&#8217;s unmistakable! The phenomenon occurs precisely when
Jacques eats peanuts and fails to brush his teeth. If only he
weren&#8217;t such a slob about dental hygiene, he&#8217;d have never even noticed
his affliction.</p>
<p><a class=p_ident id="p_tPNATV9wwS" href="#p_tPNATV9wwS"></a>Knowing this, Jacques simply stops eating peanuts altogether and finds
that this completely puts an end to his transformations.</p>
<p><a class=p_ident id="p_DXAwHKoLIY" href="#p_DXAwHKoLIY"></a>All is well with Jacques for a while. But a
few years later, he loses his job and is eventually forced to take
employment with a circus, where he performs as <em>The Incredible
Squirrelman</em> by stuffing his mouth with peanut butter before every
show. One day, fed up with this pitiful existence, Jacques fails to
change back into his human form, hops through a crack in the circus
tent, and vanishes into the forest. He is never seen again.</p>
<h2><a class=h_ident id="h_GFaxee4PuU" href="#h_GFaxee4PuU"></a>Further arrayology</h2>
<p><a class=p_ident id="p_U0+LZH9g+H" href="#p_U0+LZH9g+H"></a>Before finishing up this chapter,
I want to introduce you to a few more object-related concepts. We&#8217;ll
start by introducing some generally useful array methods.</p>
<p><a class=p_ident id="p_Wl9gXY97xi" href="#p_Wl9gXY97xi"></a>We saw <code>push</code> and <code>pop</code>, which add and remove elements at the
end of an array, <a href="04_data.html#array_methods">earlier</a> in this
chapter. The corresponding methods for adding and removing things at
the start of an array are called <code>unshift</code> and <code>shift</code>.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_9It3VS5zI/" href="#c_9It3VS5zI/"></a><span class="cm-keyword">var</span> <span class="cm-variable">todoList</span> <span class="cm-operator">=</span> [];
<span class="cm-keyword">function</span> <span class="cm-variable">rememberTo</span>(<span class="cm-def">task</span>) {
  <span class="cm-variable">todoList</span>.<span class="cm-property">push</span>(<span class="cm-variable-2">task</span>);
}
<span class="cm-keyword">function</span> <span class="cm-variable">whatIsNext</span>() {
  <span class="cm-keyword">return</span> <span class="cm-variable">todoList</span>.<span class="cm-property">shift</span>();
}
<span class="cm-keyword">function</span> <span class="cm-variable">urgentlyRememberTo</span>(<span class="cm-def">task</span>) {
  <span class="cm-variable">todoList</span>.<span class="cm-property">unshift</span>(<span class="cm-variable-2">task</span>);
}</pre>
<p><a class=p_ident id="p_msNR9KyjFO" href="#p_msNR9KyjFO"></a>The previous program manages lists of
tasks. You add tasks to the end of the list by calling
<code>rememberTo("eat")</code>, and when you&#8217;re ready to do something, you call
<code>whatIsNext()</code> to get (and remove) the front item from the list. The
<code>urgentlyRememberTo</code> function also adds a task but adds it to the
front instead of the back of the list.</p>
<p><a class=p_ident id="p_V9yB5Z4xWA" href="#p_V9yB5Z4xWA"></a>The <code>indexOf</code> method has a sibling called <code>lastIndexOf</code>,
which starts searching for the given element at the end of the array
instead of the front.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_9xeZrv5iIu" href="#c_9xeZrv5iIu"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>([<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">2</span>, <span class="cm-number">1</span>].<span class="cm-property">indexOf</span>(<span class="cm-number">2</span>));
<span class="cm-comment">// → 1</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>([<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">2</span>, <span class="cm-number">1</span>].<span class="cm-property">lastIndexOf</span>(<span class="cm-number">2</span>));
<span class="cm-comment">// → 3</span></pre>
<p><a class=p_ident id="p_hZ181L7UrW" href="#p_hZ181L7UrW"></a>Both <code>indexOf</code> and <code>lastIndexOf</code> take an optional second argument that
indicates where to start searching from.</p>
<p><a class=p_ident id="p_wxgx//Le/b" href="#p_wxgx//Le/b"></a>Another fundamental method
is <code>slice</code>, which takes a start index and an end index and returns an
array that has only the elements between those indices. The start
index is inclusive, the end index exclusive.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_+Pb+Yu6BdE" href="#c_+Pb+Yu6BdE"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>([<span class="cm-number">0</span>, <span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>].<span class="cm-property">slice</span>(<span class="cm-number">2</span>, <span class="cm-number">4</span>));
<span class="cm-comment">// → [2, 3]</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>([<span class="cm-number">0</span>, <span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>].<span class="cm-property">slice</span>(<span class="cm-number">2</span>));
<span class="cm-comment">// → [2, 3, 4]</span></pre>
<p><a class=p_ident id="p_Z01yQe26G8" href="#p_Z01yQe26G8"></a>When the end index is not given, <code>slice</code>
will take all of the elements after the start index. Strings also have
a <code>slice</code> method, which has a similar effect.</p>
<p><a class=p_ident id="p_1mS9LYSSFD" href="#p_1mS9LYSSFD"></a>The <code>concat</code> method can be used
to glue arrays together, similar to what the <code>+</code> operator does for
strings. The following example shows both <code>concat</code> and <code>slice</code> in
action. It takes an array and an index, and it returns a new array
that is a copy of the original array with the element at the given
index removed.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_P4XHOiO6e8" href="#c_P4XHOiO6e8"></a><span class="cm-keyword">function</span> <span class="cm-variable">remove</span>(<span class="cm-def">array</span>, <span class="cm-def">index</span>) {
  <span class="cm-keyword">return</span> <span class="cm-variable-2">array</span>.<span class="cm-property">slice</span>(<span class="cm-number">0</span>, <span class="cm-variable-2">index</span>)
    .<span class="cm-property">concat</span>(<span class="cm-variable-2">array</span>.<span class="cm-property">slice</span>(<span class="cm-variable-2">index</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>));
}
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">remove</span>([<span class="cm-string">"a"</span>, <span class="cm-string">"b"</span>, <span class="cm-string">"c"</span>, <span class="cm-string">"d"</span>, <span class="cm-string">"e"</span>], <span class="cm-number">2</span>));
<span class="cm-comment">// → ["a", "b", "d", "e"]</span></pre>
<h2><a class=h_ident id="h_mT4YQfwHp6" href="#h_mT4YQfwHp6"></a>Strings and their properties</h2>
<p><a class=p_ident id="p_ZbMq0Cy4Fu" href="#p_ZbMq0Cy4Fu"></a>We can read properties like <code>length</code> and
<code>toUpperCase</code> from string values. But if you try to add a new
property, it doesn&#8217;t stick.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_TjC7RNwptm" href="#c_TjC7RNwptm"></a><span class="cm-keyword">var</span> <span class="cm-variable">myString</span> <span class="cm-operator">=</span> <span class="cm-string">"Fido"</span>;
<span class="cm-variable">myString</span>.<span class="cm-property">myProperty</span> <span class="cm-operator">=</span> <span class="cm-string">"value"</span>;
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">myString</span>.<span class="cm-property">myProperty</span>);
<span class="cm-comment">// → undefined</span></pre>
<p><a class=p_ident id="p_B+oSPYAIbV" href="#p_B+oSPYAIbV"></a>Values of type string, number, and Boolean are not objects, and though
the language doesn&#8217;t complain if you try to set new properties on
them, it doesn&#8217;t actually store those properties. The values are
immutable and cannot be changed.</p>
<p><a class=p_ident id="p_8L2ib2beYN" href="#p_8L2ib2beYN"></a>But these types do have some built-in
properties. Every string value has a number of methods. The most
useful ones are probably <code>slice</code> and <code>indexOf</code>, which resemble the
array methods of the same name.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_HnK8OClqMj" href="#c_HnK8OClqMj"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"coconuts"</span>.<span class="cm-property">slice</span>(<span class="cm-number">4</span>, <span class="cm-number">7</span>));
<span class="cm-comment">// → nut</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"coconut"</span>.<span class="cm-property">indexOf</span>(<span class="cm-string">"u"</span>));
<span class="cm-comment">// → 5</span></pre>
<p><a class=p_ident id="p_RUd6q+Q4dc" href="#p_RUd6q+Q4dc"></a>One difference is that a string&#8217;s <code>indexOf</code> can take a string
containing more than one character, whereas the corresponding array
method looks only for a single element.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_rLMjIrZ6TV" href="#c_rLMjIrZ6TV"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"one two three"</span>.<span class="cm-property">indexOf</span>(<span class="cm-string">"ee"</span>));
<span class="cm-comment">// → 11</span></pre>
<p><a class=p_ident id="p_iSAQfJDhu8" href="#p_iSAQfJDhu8"></a>The <code>trim</code> method removes whitespace
(spaces, newlines, tabs, and similar characters) from the start and
end of a string.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_+59fWpnlNH" href="#c_+59fWpnlNH"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"  okay \n "</span>.<span class="cm-property">trim</span>());
<span class="cm-comment">// → okay</span></pre>
<p><a class=p_ident id="p_J4kiFmHyRO" href="#p_J4kiFmHyRO"></a>We have already seen the string type&#8217;s
<code>length</code> property. Accessing the individual characters in a string can
be done with the <code>charAt</code> method but also by simply reading numeric
properties, like you&#8217;d do for an array.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_m6+yDdVBSn" href="#c_m6+yDdVBSn"></a><span class="cm-keyword">var</span> <span class="cm-variable">string</span> <span class="cm-operator">=</span> <span class="cm-string">"abc"</span>;
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">string</span>.<span class="cm-property">length</span>);
<span class="cm-comment">// → 3</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">string</span>.<span class="cm-property">charAt</span>(<span class="cm-number">0</span>));
<span class="cm-comment">// → a</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">string</span>[<span class="cm-number">1</span>]);
<span class="cm-comment">// → b</span></pre>
<h2 id="arguments_object"><a class=h_ident id="h_GstIcsgxyb" href="#h_GstIcsgxyb"></a>The arguments object</h2>
<p><a class=p_ident id="p_8jQc6BP3jE" href="#p_8jQc6BP3jE"></a>Whenever a function is called, a special variable named
<code>arguments</code> is added to the environment in which the function body
runs. This variable refers to an object that holds all of the
arguments passed to the function. Remember that in JavaScript you are
allowed to pass more (or fewer) arguments to a function than the
number of parameters the function itself declares.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_vGR3ohSBVO" href="#c_vGR3ohSBVO"></a><span class="cm-keyword">function</span> <span class="cm-variable">noArguments</span>() {}
<span class="cm-variable">noArguments</span>(<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>); <span class="cm-comment">// This is okay</span>
<span class="cm-keyword">function</span> <span class="cm-variable">threeArguments</span>(<span class="cm-def">a</span>, <span class="cm-def">b</span>, <span class="cm-def">c</span>) {}
<span class="cm-variable">threeArguments</span>(); <span class="cm-comment">// And so is this</span></pre>
<p><a class=p_ident id="p_X05+xpRc+j" href="#p_X05+xpRc+j"></a>The <code>arguments</code> object has a <code>length</code> property
that tells us the number of arguments that were really passed to the
function. It also has a property for each argument, named 0, 1, 2, and
so on.</p>
<p><a class=p_ident id="p_r7f/a3/GFP" href="#p_r7f/a3/GFP"></a>If that sounds a lot like an array to you,
you&#8217;re right, it <em>is</em> a lot like an array. But this object,
unfortunately, does not have any array methods (like <code>slice</code> or
<code>indexOf</code>), so it is a little harder to use than a real array.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_DkiKhdVpsZ" href="#c_DkiKhdVpsZ"></a><span class="cm-keyword">function</span> <span class="cm-variable">argumentCounter</span>() {
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"You gave me"</span>, <span class="cm-variable-2">arguments</span>.<span class="cm-property">length</span>, <span class="cm-string">"arguments."</span>);
}
<span class="cm-variable">argumentCounter</span>(<span class="cm-string">"Straw man"</span>, <span class="cm-string">"Tautology"</span>, <span class="cm-string">"Ad hominem"</span>);
<span class="cm-comment">// → You gave me 3 arguments.</span></pre>
<p><a class=p_ident id="p_MIxvg5Tzop" href="#p_MIxvg5Tzop"></a>Some functions
can take any number of arguments, like <code>console.log</code>. These typically
loop over the values in their <code>arguments</code> object. They can be used to
create very pleasant interfaces. For example, remember how we created
the entries to Jacques’ journal.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_+nwtWR/ELx" href="#c_+nwtWR/ELx"></a><span class="cm-variable">addEntry</span>([<span class="cm-string">"work"</span>, <span class="cm-string">"touched tree"</span>, <span class="cm-string">"pizza"</span>, <span class="cm-string">"correr"</span>,
          <span class="cm-string">"television"</span>], <span class="cm-atom">false</span>);</pre>
<p><a class=p_ident id="p_2WHMCXaaIn" href="#p_2WHMCXaaIn"></a>Since he is going to be calling this function a lot, we could create
an alternative that is easier to call.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_mJiHtSVFDT" href="#c_mJiHtSVFDT"></a><span class="cm-keyword">function</span> <span class="cm-variable">addEntry</span>(<span class="cm-def">squirrel</span>) {
  <span class="cm-keyword">var</span> <span class="cm-def">entry</span> <span class="cm-operator">=</span> {<span class="cm-property">events</span>: [], <span class="cm-property">squirrel</span>: <span class="cm-variable-2">squirrel</span>};
  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">arguments</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>)
    <span class="cm-variable-2">entry</span>.<span class="cm-property">events</span>.<span class="cm-property">push</span>(<span class="cm-variable-2">arguments</span>[<span class="cm-variable-2">i</span>]);
  <span class="cm-variable">journal</span>.<span class="cm-property">push</span>(<span class="cm-variable-2">entry</span>);
}
<span class="cm-variable">addEntry</span>(<span class="cm-atom">true</span>, <span class="cm-string">"work"</span>, <span class="cm-string">"touched tree"</span>, <span class="cm-string">"pizza"</span>,
         <span class="cm-string">"running"</span>, <span class="cm-string">"television"</span>);</pre>
<p><a class=p_ident id="p_o3+Bq1M1pm" href="#p_o3+Bq1M1pm"></a>This version reads its first argument
(<code>squirrel</code>) in the normal way and then goes over the rest of the
arguments (the loop starts at index 1, skipping the first) to gather
them into an array.</p>
<h2><a class=h_ident id="h_C51DnYk8WZ" href="#h_C51DnYk8WZ"></a>The Math object</h2>
<p><a class=p_ident id="p_9S5JZybGFD" href="#p_9S5JZybGFD"></a>As we&#8217;ve seen, <code>Math</code> is a grab-bag of number-related utility
functions, such as <code>Math.max</code> (maximum), <code>Math.min</code> (minimum), and
<code>Math.sqrt</code> (square root).</p>
<p id="namespace_pollution"><a class=p_ident id="p_YvGRywRVYj" href="#p_YvGRywRVYj"></a>The
<code>Math</code> object is used simply as a container to group a bunch of
related functionality. There is only one <code>Math</code> object, and it is
almost never useful as a value. Rather, it provides a <em>namespace</em> so
that all these functions and values do not have to be global
variables.</p>
<p><a class=p_ident id="p_fGEMziAXhp" href="#p_fGEMziAXhp"></a>Having too many global variables “pollutes” the
namespace. The more names that have been taken, the more likely you
are to accidentally overwrite the value of some variable. For example,
it&#8217;s not unlikely that you&#8217;ll want to name something <code>max</code> in one of
your programs. Since JavaScript&#8217;s built-in <code>max</code> function is tucked
safely inside the <code>Math</code> object, we don&#8217;t have to worry about
overwriting it.</p>
<p><a class=p_ident id="p_tEjnm+nh21" href="#p_tEjnm+nh21"></a>Many languages will stop you, or at least warn you, when you are
defining a variable with a name that is already taken. JavaScript does
neither, so be careful.</p>
<p><a class=p_ident id="p_zWXQRNgLI/" href="#p_zWXQRNgLI/"></a>Back to
the <code>Math</code> object. If you need to do trigonometry, <code>Math</code> can
help. It contains <code>cos</code> (cosine), <code>sin</code> (sine), and <code>tan</code> (tangent),
as well as their inverse functions, <code>acos</code>, <code>asin</code>, and <code>atan</code>, respectively. The
number π (pi)—or at least the closest approximation that fits in a
JavaScript number—is available as <code>Math.PI</code>. (There is an old
programming tradition of writing the names of constant values in
all caps.)</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_jVEDhgK+XA" href="#c_jVEDhgK+XA"></a><span class="cm-keyword">function</span> <span class="cm-variable">randomPointOnCircle</span>(<span class="cm-def">radius</span>) {
  <span class="cm-keyword">var</span> <span class="cm-def">angle</span> <span class="cm-operator">=</span> <span class="cm-variable">Math</span>.<span class="cm-property">random</span>() <span class="cm-operator">*</span> <span class="cm-number">2</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">PI</span>;
  <span class="cm-keyword">return</span> {<span class="cm-property">x</span>: <span class="cm-variable-2">radius</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">cos</span>(<span class="cm-variable-2">angle</span>),
          <span class="cm-property">y</span>: <span class="cm-variable-2">radius</span> <span class="cm-operator">*</span> <span class="cm-variable">Math</span>.<span class="cm-property">sin</span>(<span class="cm-variable-2">angle</span>)};
}
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">randomPointOnCircle</span>(<span class="cm-number">2</span>));
<span class="cm-comment">// → {x: 0.3667, y: 1.966}</span></pre>
<p><a class=p_ident id="p_4kTWFGWGMm" href="#p_4kTWFGWGMm"></a>If sines and cosines are not something you are very familiar with,
don&#8217;t worry. When they are used in this book, in
<a href="13_dom.html#sin_cos">Chapter 13</a>, I&#8217;ll explain them.</p>
<p><a class=p_ident id="p_a6xMq73yCc" href="#p_a6xMq73yCc"></a>The previous example
uses <code>Math.random</code>. This is a function that returns a new
pseudorandom number between zero (inclusive) and one (exclusive)
every time you call it.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_NbplV6vA2g" href="#c_NbplV6vA2g"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">Math</span>.<span class="cm-property">random</span>());
<span class="cm-comment">// → 0.36993729369714856</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">Math</span>.<span class="cm-property">random</span>());
<span class="cm-comment">// → 0.727367032552138</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">Math</span>.<span class="cm-property">random</span>());
<span class="cm-comment">// → 0.40180766698904335</span></pre>
<p><a class=p_ident id="p_LqSZpx/sgf" href="#p_LqSZpx/sgf"></a>Though computers are
deterministic machines—they always react the same way if given the
same input—it is possible to have them produce numbers that appear
random. To do this, the machine keeps a number (or a bunch of numbers)
in its internal state. Then, every time a random number is requested,
it performs some complicated deterministic computations on this
internal state and returns part of the result of those computations.
The machine also uses the outcome to change its own internal state so
that the next “random” number produced will be different.</p>
<p><a class=p_ident id="p_WnBKL1c/CF" href="#p_WnBKL1c/CF"></a>If we want a whole random
number instead of a fractional one, we can use <code>Math.floor</code> (which
rounds down to the nearest whole number) on the result of
<code>Math.random</code>.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_UvYBav4xt5" href="#c_UvYBav4xt5"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">Math</span>.<span class="cm-property">floor</span>(<span class="cm-variable">Math</span>.<span class="cm-property">random</span>() <span class="cm-operator">*</span> <span class="cm-number">10</span>));
<span class="cm-comment">// → 2</span></pre>
<p><a class=p_ident id="p_52aDRkOsyH" href="#p_52aDRkOsyH"></a>Multiplying the random number by 10 gives us a number greater than or
equal to zero, and below 10. Since <code>Math.floor</code> rounds down, this
expression will produce, with equal chance, any number from 0 through
9.</p>
<p><a class=p_ident id="p_1pKvkjRw0T" href="#p_1pKvkjRw0T"></a>There are also the
functions <code>Math.ceil</code> (for “ceiling”, which rounds up to a whole
number) and <code>Math.round</code> (to the nearest whole number).</p>
<h2><a class=h_ident id="h_lRBZxXmo93" href="#h_lRBZxXmo93"></a>The global object</h2>
<p><a class=p_ident id="p_+IF2SIC4YV" href="#p_+IF2SIC4YV"></a>The global scope, the space in which
global variables live, can also be approached as an object in
JavaScript. Each global variable is present as a property of this
object. In browsers, the global scope object is stored in the
<code>window</code> variable.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_YaSzv1qE8W" href="#c_YaSzv1qE8W"></a><span class="cm-keyword">var</span> <span class="cm-variable">myVar</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>;
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"myVar"</span> <span class="cm-keyword">in</span> <span class="cm-variable">window</span>);
<span class="cm-comment">// → true</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">window</span>.<span class="cm-property">myVar</span>);
<span class="cm-comment">// → 10</span></pre>
<h2><a class=h_ident id="h_ErccPg/l98" href="#h_ErccPg/l98"></a>Summary</h2>
<p><a class=p_ident id="p_78ZfHX5x1B" href="#p_78ZfHX5x1B"></a>Objects and arrays (which are a specific kind of object) provide ways
to group several values into a single value. Conceptually, this allows
us to put a bunch of related things in a bag and run around with the
bag, instead of trying to wrap our arms around all of the individual
things and trying to hold on to them separately.</p>
<p><a class=p_ident id="p_ayhyxvWlMH" href="#p_ayhyxvWlMH"></a>Most values in JavaScript have properties, the exceptions being <code>null</code>
and <code>undefined</code>. Properties are accessed using <code>value.propName</code> or
<code>value["propName"]</code>. Objects tend to use names for their properties
and store more or less a fixed set of them. Arrays, on the other hand,
usually contain varying numbers of conceptually identical values and
use numbers (starting from 0) as the names of their properties.</p>
<p><a class=p_ident id="p_1lcitbawCQ" href="#p_1lcitbawCQ"></a>There <em>are</em> some named properties in arrays, such as <code>length</code> and a
number of methods. Methods are functions that live in properties and
(usually) act on the value they are a property of.</p>
<p><a class=p_ident id="p_ZtRACiqRCK" href="#p_ZtRACiqRCK"></a>Objects can also serve as maps, associating values with names. The <code>in</code>
operator can be used to find out whether an object contains a property with
a given name. The same keyword can also be used in a <code>for</code> loop
(<code>for (var name in object)</code>) to loop over an object&#8217;s properties.</p>
<h2><a class=h_ident id="h_TcUD2vzyMe" href="#h_TcUD2vzyMe"></a>Exercises</h2>
<h3><a class=h_ident id="h_8ZspxiCEC/" href="#h_8ZspxiCEC/"></a>The sum of a range</h3>
<p><a class=p_ident id="p_fpyyiv/hm1" href="#p_fpyyiv/hm1"></a>The <a href="00_intro.html#intro">introduction</a> of this book alluded to the
following as a nice way to compute the sum of a range of numbers:</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_OULOwD7HOm" href="#c_OULOwD7HOm"></a><span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">sum</span>(<span class="cm-variable">range</span>(<span class="cm-number">1</span>, <span class="cm-number">10</span>)));</pre>
<p><a class=p_ident id="p_PkFb/61ecP" href="#p_PkFb/61ecP"></a>Write a <code>range</code> function that
takes two arguments, <code>start</code> and <code>end</code>, and returns an array
containing all the numbers from <code>start</code> up to (and including) <code>end</code>.</p>
<p><a class=p_ident id="p_0GiJNcBSop" href="#p_0GiJNcBSop"></a>Next, write a <code>sum</code> function that takes an array of numbers and
returns the sum of these numbers. Run the previous program and see
whether it does indeed return 55.</p>
<p><a class=p_ident id="p_T5lVUHvYnd" href="#p_T5lVUHvYnd"></a>As a bonus assignment, modify your <code>range</code>
function to take an optional third argument that indicates the “step”
value used to build up the array. If no step is given, the array
elements go up by increments of one, corresponding to the old
behavior. The function call <code>range(1, 10, 2)</code> should return <code>[1, 3, 5,
7, 9]</code>. Make sure it also works with negative step values so that
<code>range(5, 2, -1)</code> produces <code>[5, 4, 3, 2]</code>.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_/BQ7zA128c" href="#c_/BQ7zA128c"></a><span class="cm-comment">// Your code here.</span>

<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">range</span>(<span class="cm-number">1</span>, <span class="cm-number">10</span>));
<span class="cm-comment">// → [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">range</span>(<span class="cm-number">5</span>, <span class="cm-number">2</span>, <span class="cm-operator">-</span><span class="cm-number">1</span>));
<span class="cm-comment">// → [5, 4, 3, 2]</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">sum</span>(<span class="cm-variable">range</span>(<span class="cm-number">1</span>, <span class="cm-number">10</span>)));
<span class="cm-comment">// → 55</span></pre>
<div class=solution><div class=solution-text>
<p><a class=p_ident id="p_AzWVqPrlre" href="#p_AzWVqPrlre"></a>Building up an array is most easily done by first
initializing a variable to <code>[]</code> (a fresh, empty array) and repeatedly
calling its <code>push</code> method to add a value. Don&#8217;t forget to return the
array at the end of the function.</p>
<p><a class=p_ident id="p_eu6MUPwjEb" href="#p_eu6MUPwjEb"></a>Since the end boundary is
inclusive, you&#8217;ll need to use the <code>&lt;=</code> operator rather than simply <code>&lt;</code>
to check for the end of your loop.</p>
<p><a class=p_ident id="p_gp8gSa5PFL" href="#p_gp8gSa5PFL"></a>To check whether the optional step argument was
given, either check <code>arguments.length</code> or compare the value of the
argument to <code>undefined</code>. If it wasn&#8217;t given, simply set it to its
default value (1) at the top of the function.</p>
<p><a class=p_ident id="p_xfC3xdBYBn" href="#p_xfC3xdBYBn"></a>Having <code>range</code> understand negative
step values is probably best done by writing two separate loops—one
for counting up and one for counting down—because the comparison that
checks whether the loop is finished needs to be <code>&gt;=</code> rather than <code>&lt;=</code>
when counting downward.</p>
<p><a class=p_ident id="p_kHSmZmF/0k" href="#p_kHSmZmF/0k"></a>It might also be worthwhile to use a different default step, namely,
-1, when the end of the range is smaller than the start. That way,
<code>range(5, 2)</code> returns something meaningful, rather than getting stuck
in an infinite loop.</p>
</div></div>
<h3><a class=h_ident id="h_6xTmjj4Rf5" href="#h_6xTmjj4Rf5"></a>Reversing an array</h3>
<p><a class=p_ident id="p_0ysB6LgssH" href="#p_0ysB6LgssH"></a>Arrays have a method <code>reverse</code>, which
changes the array by inverting the order in which its elements appear.
For this exercise, write two functions, <code>reverseArray</code> and
<code>reverseArrayInPlace</code>. The first, <code>reverseArray</code>, takes an array as
argument and produces a <em>new</em> array that has the same elements in the
inverse order. The second, <code>reverseArrayInPlace</code>, does what the
<code>reverse</code> method does: it modifies the array given as argument in
order to reverse its elements. Neither may use the standard
<code>reverse</code> method.</p>
<p><a class=p_ident id="p_0WdqLyJAyQ" href="#p_0WdqLyJAyQ"></a>Thinking back to
the notes about side effects and pure functions in the
<a href="03_functions.html#pure">previous chapter</a>, which variant do you
expect to be useful in more situations? Which one is more efficient?</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_at6e0JhJjg" href="#c_at6e0JhJjg"></a><span class="cm-comment">// Your code here.</span>

<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">reverseArray</span>([<span class="cm-string">"A"</span>, <span class="cm-string">"B"</span>, <span class="cm-string">"C"</span>]));
<span class="cm-comment">// → ["C", "B", "A"];</span>
<span class="cm-keyword">var</span> <span class="cm-variable">arrayValue</span> <span class="cm-operator">=</span> [<span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>, <span class="cm-number">5</span>];
<span class="cm-variable">reverseArrayInPlace</span>(<span class="cm-variable">arrayValue</span>);
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">arrayValue</span>);
<span class="cm-comment">// → [5, 4, 3, 2, 1]</span></pre>
<div class=solution><div class=solution-text>
<p><a class=p_ident id="p_pyY1QGL0wk" href="#p_pyY1QGL0wk"></a>There are two obvious ways to implement
<code>reverseArray</code>. The first is to simply go over the input array from
front to back and use the <code>unshift</code> method on the new array to insert
each element at its start. The second is to loop over the input array
backward and use the <code>push</code> method. Iterating over an array backward
requires a (somewhat awkward) <code>for</code> specification like <code>(var i =
array.length - 1; i &gt;= 0; i--)</code>.</p>
<p><a class=p_ident id="p_Y08sN3Yej5" href="#p_Y08sN3Yej5"></a>Reversing the array in place is harder. You have to be careful not to
overwrite elements that you will later need. Using <code>reverseArray</code> or
otherwise copying the whole array (<code>array.slice(0)</code> is a good way to
copy an array) works but is cheating.</p>
<p><a class=p_ident id="p_hzYSkS4zzl" href="#p_hzYSkS4zzl"></a>The trick is to <em>swap</em> the first and last elements, then the
second and second-to-last, and so on. You can do this by looping
over half the length of the array (use <code>Math.floor</code> to round down—you
don&#8217;t need to touch the middle element in an array with an odd
length) and swapping the element at position <code>i</code> with the one at
position <code>array.length - 1 - i</code>. You can use a local variable to
briefly hold on to one of the elements, overwrite that one with its
mirror image, and then put the value from the local variable in the
place where the mirror image used to be.</p>
</div></div>
<h3 id="list"><a class=h_ident id="h_nSTX34CM1M" href="#h_nSTX34CM1M"></a>A list</h3>
<p><a class=p_ident id="p_7AnSuS26HF" href="#p_7AnSuS26HF"></a>Objects, as generic
blobs of values, can be used to build all sorts of data structures. A
common data structure is the <em>list</em> (not to be confused with the
array). A list is a nested set of objects, with the first object
holding a reference to the second, the second to the third, and so on.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_WcmR7ylTJy" href="#c_WcmR7ylTJy"></a><span class="cm-keyword">var</span> <span class="cm-variable">list</span> <span class="cm-operator">=</span> {
  <span class="cm-property">value</span>: <span class="cm-number">1</span>,
  <span class="cm-property">rest</span>: {
    <span class="cm-property">value</span>: <span class="cm-number">2</span>,
    <span class="cm-property">rest</span>: {
      <span class="cm-property">value</span>: <span class="cm-number">3</span>,
      <span class="cm-property">rest</span>: <span class="cm-atom">null</span>
    }
  }
};</pre>
<p><a class=p_ident id="p_2un5u6U14Q" href="#p_2un5u6U14Q"></a>The resulting objects form a chain, like this:</p>
<div class="image">
  <img src="img/linked-list.svg" alt="A linked list">
</div>
<p><a class=p_ident id="p_NaI0fhp38z" href="#p_NaI0fhp38z"></a>A nice thing about lists is that
they can share parts of their structure. For example, if I create two
new values <code>{value: 0, rest: list}</code> and <code>{value: -1, rest: list}</code>
(with <code>list</code> referring to the variable defined earlier), they are both
independent lists, but they share the structure that makes up their
last three elements. In addition, the original list is also still a
valid three-element list.</p>
<p><a class=p_ident id="p_iPlgVCeZGh" href="#p_iPlgVCeZGh"></a>Write a function <code>arrayToList</code> that builds up a data structure like
the previous one when given <code>[1, 2, 3]</code> as argument, and write a
<code>listToArray</code> function that produces an array from a list. Also write
the helper functions <code>prepend</code>, which takes an element and a list and
creates a new list that adds the element to the front of the input
list, and <code>nth</code>, which takes a list and a number and returns the
element at the given position in the list, or <code>undefined</code> when there
is no such element.</p>
<p><a class=p_ident id="p_IZMCvYT0l2" href="#p_IZMCvYT0l2"></a>If you haven&#8217;t already, also write a recursive version
of <code>nth</code>.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_lGyZZnlBgy" href="#c_lGyZZnlBgy"></a><span class="cm-comment">// Your code here.</span>

<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">arrayToList</span>([<span class="cm-number">10</span>, <span class="cm-number">20</span>]));
<span class="cm-comment">// → {value: 10, rest: {value: 20, rest: null}}</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">listToArray</span>(<span class="cm-variable">arrayToList</span>([<span class="cm-number">10</span>, <span class="cm-number">20</span>, <span class="cm-number">30</span>])));
<span class="cm-comment">// → [10, 20, 30]</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">prepend</span>(<span class="cm-number">10</span>, <span class="cm-variable">prepend</span>(<span class="cm-number">20</span>, <span class="cm-atom">null</span>)));
<span class="cm-comment">// → {value: 10, rest: {value: 20, rest: null}}</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">nth</span>(<span class="cm-variable">arrayToList</span>([<span class="cm-number">10</span>, <span class="cm-number">20</span>, <span class="cm-number">30</span>]), <span class="cm-number">1</span>));
<span class="cm-comment">// → 20</span></pre>
<div class=solution><div class=solution-text>
<p><a class=p_ident id="p_gUGYq9Tjlx" href="#p_gUGYq9Tjlx"></a>Building up a list is best done
back to front. So <code>arrayToList</code> could iterate over the array backward
(see previous exercise) and, for each element, add an object to the
list. You can use a local variable to hold the part of the list that
was built so far and use a pattern like <code>list = {value: X, rest:
list}</code> to add an element.</p>
<p><a class=p_ident id="p_+rJULr60CD" href="#p_+rJULr60CD"></a>To run over a list (in <code>listToArray</code> and <code>nth</code>), a <code>for</code>
loop specification like this can be used:</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_ozaUfY2r+R" href="#c_ozaUfY2r+R"></a><span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">node</span> <span class="cm-operator">=</span> <span class="cm-variable">list</span>; <span class="cm-variable">node</span>; <span class="cm-variable">node</span> <span class="cm-operator">=</span> <span class="cm-variable">node</span>.<span class="cm-property">rest</span>) {}</pre>
<p><a class=p_ident id="p_LnwEAnSmsp" href="#p_LnwEAnSmsp"></a>Can you see how that works? Every iteration of the loop, <code>node</code> points
to the current sublist, and the body can read its <code>value</code> property to
get the current element. At the end of an iteration, <code>node</code> moves to
the next sublist. When that is null, we have reached the end of the
list and the loop is finished.</p>
<p><a class=p_ident id="p_vwViRUdBme" href="#p_vwViRUdBme"></a>The recursive version of <code>nth</code> will, similarly, look at
an ever smaller part of the “tail” of the list and at the same time
count down the index until it reaches zero, at which point it can
return the <code>value</code> property of the node it is looking at. To get the
zeroeth element of a list, you simply take the <code>value</code> property of its
head node. To get element <em>N</em> + 1, you take the <em>N</em>th element of the
list that&#8217;s in this list&#8217;s <code>rest</code> property.</p>
</div></div>
<h3 id="exercise_deep_compare"><a class=h_ident id="h_IJBU+aXOIC" href="#h_IJBU+aXOIC"></a>Deep comparison</h3>
<p><a class=p_ident id="p_xTwbRlqHNJ" href="#p_xTwbRlqHNJ"></a>The <code>==</code> operator compares objects by
identity. But sometimes, you would prefer to compare the values of
their actual properties.</p>
<p><a class=p_ident id="p_gndt0hmgga" href="#p_gndt0hmgga"></a>Write a function, <code>deepEqual</code>, that takes two values and returns true
only if they are the same value or are objects with the same
properties whose values are also equal when compared with a recursive
call to <code>deepEqual</code>.</p>
<p><a class=p_ident id="p_kFIc5gkwlo" href="#p_kFIc5gkwlo"></a>To find out whether
to compare two things by identity (use the <code>===</code> operator for that) or
by looking at their properties, you can use the <code>typeof</code> operator. If
it produces <code>"object"</code> for both values, you should do a deep
comparison. But you have to take one silly exception into account: by
a historical accident, <code>typeof null</code> also produces <code>"object"</code>.</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class=c_ident id="c_sxBAJyq2QR" href="#c_sxBAJyq2QR"></a><span class="cm-comment">// Your code here.</span>

<span class="cm-keyword">var</span> <span class="cm-variable">obj</span> <span class="cm-operator">=</span> {<span class="cm-property">here</span>: {<span class="cm-property">is</span>: <span class="cm-string">"an"</span>}, <span class="cm-property">object</span>: <span class="cm-number">2</span>};
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">deepEqual</span>(<span class="cm-variable">obj</span>, <span class="cm-variable">obj</span>));
<span class="cm-comment">// → true</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">deepEqual</span>(<span class="cm-variable">obj</span>, {<span class="cm-property">here</span>: <span class="cm-number">1</span>, <span class="cm-property">object</span>: <span class="cm-number">2</span>}));
<span class="cm-comment">// → false</span>
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">deepEqual</span>(<span class="cm-variable">obj</span>, {<span class="cm-property">here</span>: {<span class="cm-property">is</span>: <span class="cm-string">"an"</span>}, <span class="cm-property">object</span>: <span class="cm-number">2</span>}));
<span class="cm-comment">// → true</span></pre>
<div class=solution><div class=solution-text>
<p><a class=p_ident id="p_t3z+oosxP9" href="#p_t3z+oosxP9"></a>Your test for whether you are dealing with a
real object will look something like <code>typeof x == "object" &amp;&amp; x !=
null</code>. Be careful to compare properties only when <em>both</em> arguments are
objects. In all other cases you can just immediately return the result
of applying <code>===</code>.</p>
<p><a class=p_ident id="p_fyoBIInROR" href="#p_fyoBIInROR"></a>Use a <code>for</code>/<code>in</code> loop to go over the
properties. You need to test whether both objects have the same set of
property names and whether those properties have identical values. The
first test can be done by counting the properties in both objects and
returning false if the numbers of properties are different. If they&#8217;re
the same, then go over the properties of one object, and for each of
them, verify that the other object also has the property. The values
of the properties are compared by a recursive call to <code>deepEqual</code>.</p>
<p><a class=p_ident id="p_ECXa1sWg6+" href="#p_ECXa1sWg6+"></a>Returning the correct value from the function is
best done by immediately returning false when a mismatch is noticed
and returning true at the end of the function.</p>
</div></div>
<nav>
  <a href="03_functions.html" title="capítulo previo">◀</a>
  <a href="index.html" title="cover">◆</a>
  <a href="05_higher_order.html" title="capítulo siguiente">▶</a>
</nav>
</article>
